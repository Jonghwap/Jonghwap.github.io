{% assign items = include.talks | default: site.talks %}
{% if items and items.size > 0 %}
{% assign has_order = items | where_exp: "t", "t.order" %}
{% if has_order and has_order.size == items.size %}
{% comment %}Respect manual ordering when every item provides an order field (higher numbers appear first).{% endcomment %}
{% assign sorted = items | sort: "order" | reverse %}
{% else %}
{% comment %}Fallback ordering: sort by conference name, then date (newest first).{% endcomment %}
{% assign sorted_by_conference = items | sort: "conference" %}
{% assign sorted = sorted_by_conference | sort: "date" | reverse %}
{% endif %}
<ul class="talk-list">
  {% for talk in sorted %}
  <li class="talk-entry">
    <span class="talk-bullet">#</span>
    <div class="talk-details">
      {% comment %}Show the month/year string exactly as specified in the talk's front matter date field.{% endcomment %}
      <div class="talk-primary"><strong>{{ talk.conference }}</strong>, {{ talk.date | date: "%b %Y" }}</div>
      <div class="talk-secondary">{{ talk.location }}, {{ talk.country }}</div>
      {% assign slides_link = talk.slides | default: '' | strip %}
      {% assign poster_link = talk.poster | default: '' | strip %}
      {% assign has_slides = slides_link | size %}
      {% assign has_poster = poster_link | size %}
      {% assign show_link_row = has_slides | plus: has_poster %}
      {% if show_link_row > 0 %}
      <span class="talk-links">
        {% if has_slides > 0 %}
        <a class="slides-button" href="{{ slides_link }}" target="_blank" rel="noopener">slides</a>
        {% endif %}
        {% if has_poster > 0 %}
        <a class="poster-button" href="{{ poster_link }}" target="_blank" rel="noopener">poster</a>
        {% endif %}
      </span>
      {% endif %}      
    </div>
  </li>
  {% endfor %}
</ul>
{% else %}
<p>No talks have been added yet. Add entries under <code>_talks/</code> to list them.</p>
{% endif %}
